---
title: "Dockerメモ"
templateKey: blog-post
date: 2020-07-09T14:56:00+09:00
tags: [Docker]
draft: true
---

## Dockerfile 記載の指針

<!--more-->

- コンテナはエフェメラル(ephemeral)であるべき。停止・破壊可能で最小セットアップで使える。
- 空のディレクトリにここの Dockerfile を置く。
- dockerignore を置く
- 不要なパッケージのインストールを避ける
- コンテナ毎に一つのプロセスだけ実行
- レイヤの数を最小に
- 複数行の引数
- 構築キャッシュ
- FROM 可能であれば元として現在の公式レポジトリを使う
- RUN apt-get は update 以下&&でつなぐ
- CMD ソフトウェアの実行に使う。他のケースではインタラクティブなシェルに使う
- EXPOSE 伝統的なポートを使う
- ENV パスを通す。またサービスが必要な環境変数
- バージョン番号の指定に使う
- ADD と COPY  
  COPY が望ましい(ADD は高機能なため)　リモート上のパッケージの取得は ADD ではなく curl か wget を使う
- ENTRYPOINT イメージにおけるメインコマンドの設定(この場合 CMD がデフォルトのフラグ)
- VOLUME データベースストレージ、設定用ストレージ、コンテナによって作成されるファイルやフォルダの公開用
- WORKDIR
  常に WORK からの絶対パスを使うべき
